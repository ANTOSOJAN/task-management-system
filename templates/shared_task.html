<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ board.title }} - Shared Task Management</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <h1>{{ board.title }} - Shared Task Board</h1>
    <p>{{ board.description or "No description available." }}</p>
    <p><strong>Created by:</strong> <span class="creator">{{ creator_email }}</span></p>

    <div class="section">
        <h2>Members</h2>
        <ul>
            {% for member in members %}
                <li>
                    <code>{{ member.email }}</code>
                    {% if member.email == creator_email %}
                        <span class="creator">(Creator)</span>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    </div>

    {% if board.is_creator %}
        <div class="section">
            <h2>Add New Task</h2>
            <form method="post" action="/board/{{ board.id }}/add-task">
                <input type="text" name="title" placeholder="Task title" required>
                <input type="date" name="due_date" required>
                <label>Select users to assign:</label>
                <select name="assignees" multiple required size="4">
                    {% for member in members %}
                        <option value="{{ member.email }}">{{ member.email }}</option>
                    {% endfor %}
                </select>
                <br><br>
                <button type="submit">Create Task</button>
            </form>
        </div>
    {% endif %}

    <div class="section">
        <h2>Tasks on This Board</h2>
        {% if tasks|length == 0 %}
            <p>No tasks added yet.</p>
        {% else %}
            {% for task in tasks %}
                <div class="task {% if task.completed %}completed{% endif %}">
                    <form method="post" action="/board/{{ board.id }}/task/{{ task.id }}/toggle">
                        <strong>{{ task.title }}</strong>  Due: {{ task.due_date }}
                        <br>
                        Assigned to: <code>{{ task.assignees | join(', ') }}</code>
                        <br>
                        <button type="submit">
                            {% if task.completed %}Mark Incomplete{% else %}Mark Complete{% endif %}
                        </button>
                    </form>
                </div>
            {% endfor %}
        {% endif %}
    </div>

    <div class="section">
        <a href="/">‚Üê Back to Dashboard</a>
    </div>
</body>
</html>